webpackJsonp([1],{176:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e){var t=e.status;if(t>=200&&t<300)return e;var r=new Error(e.statusText);throw r.errorCode=t,r}function i(e){var t=e.url,r=e.body,n=void 0===r?{}:r,i=e.method,s=void 0===i?"get":i,c=e.options,f=void 0===c?{}:c;if(!t){var p=new Error("请传入 url");return p.errorCode=0,Promise.reject(p)}var d="";d=0===t.indexOf("http")?t:""+t;var h=a({method:s},l,f);return"get"!==s&&"head"!==s&&(Object.keys(n).forEach(function(e){null!==n[e]&&""!==n[e]||delete n[e]}),h.body=u["default"].stringifyJSON(n)),fetch(d,h).then(o).then(function(e){return e.json().then(function(t){return{json:t,response:e}})}).then(function(e){var t=e.json;if(!e.response.ok||"00000"!==t.code){var r=new Error(t.msg||"获取数据出错");return r.code=t.code,Promise.reject(t.msg||"获取数据出错",r)}return t})["catch"](function(e){return Promise.reject(e||"网络错误")})}Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};r(178);var s=r(177),u=n(s),l={credentials:"include",headers:{Accept:"application/json","Content-Type":"application/json; charset=utf-8"}};t["default"]=i},177:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=t.getLocationParams=function(){var e=location.search;if(e.length>1){var t={};return e=e.substring(1),e.split("&").forEach(function(e){var r=e.split("=");t[r[0]]=""===r[1]?null:decodeURIComponent(r[1])}),t}return null},i=t.getLocationOrigin=function(){return location.origin?location.origin:location.protocol+"//"+location.host},a=t.getLocationRoot=function(){var e=location.pathname;return location.origin+e.match(/\/[\w\d-]+\//)[0]},s=t.getLocationContext=function(){return location.pathname.match(/\/[\w\d-]+\//)[0]},u=t.parseJSON=function(e){if(!e)return null;var t=null;try{t=JSON.parse(e)}catch(e){t=null,console.info(e)}return t},l=t.stringifyJSON=function(e){var t=null;try{t=JSON.stringify(e)}catch(e){t=null,console.info(e)}return t},c=t.formatDate=function(e){var t=e.time,r=e.showMs,n=void 0!==r&&r,o=e.showYear,i=void 0!==o&&o;if(!t)return"";var a=new Date(Number(t));if("Invalid Date"===a.toString()&&(a=(void 0).createDate(t),"Invalid Date"===a.toString()))return"";var s=a.getHours()<=9?"0"+a.getHours():a.getHours(),u=a.getMinutes()<=9?"0"+a.getMinutes():a.getMinutes(),l=a.getSeconds()<=9?"0"+a.getSeconds():a.getSeconds(),c=a.getMilliseconds();c<=9?c="00"+c:c<=99&&(c="0"+c);var f=n?" "+s+":"+u+":"+l+"."+c:" "+s+":"+u+":"+l,p=a.getFullYear(),d=a.getMonth()+1;d=d<=9?"0"+d:d;var h=a.getDate();return h=h<=9?"0"+h:h,(i?p+"-":"")+d+"-"+h+f},f=t.createDate=function(e){if(!e||"string"!=typeof e)return null;var t=0,r=0,n=0,o=0,i=0,a=0,s=0,u=e.replace(/\//g,"-").split(" ");if(u.length>0){var l=u[0].split("-");t=Number(l[0]),r=Number(l[1])-1,n=Number(l[2])}if(2===u.length){var c=u[1].split(":");o=Number(c[0]),i=Number(c[1]);var f=c[2].split(".");2===f.length?(a=Number(f[0]),s=Number(f[1])):a=Number(c[2]),c[3]&&(s=c[3])}return new Date(t,r,n,o,i,a,s)},p=t.styleSupport=function(e){var t=["webkit","moz","ms","o"],r=document.createElement("div"),n=r.style;if(void 0!==n[e])return!0;for(var o=0;o<t.length;o++){if(void 0!==n[t[o]+e[0].toUpperCase()+e.substring(1)])return!0}return!1},d=(t.historyH5Support=function(){return history.pushState&&history.replaceState},t.ie8=function(){var e=window.navigator,t=e.appName,r=e.appVersion,n=r.split(";");return!!n[1]&&(r=n[1].replace(/[ ]/g,""),"Microsoft Internet Explorer"===t&&"MSIE8.0"===r)}(),t.ie9=function(){var e=window.navigator,t=e.appName,r=e.appVersion,n=r.split(";");return!!n[1]&&(r=n[1].replace(/[ ]/g,""),"Microsoft Internet Explorer"===t&&"MSIE9.0"===r)}(),t.ltIe10=function(){var e=window.navigator,t=e.appName,r=e.appVersion,n=r.split(";");return!!n[1]&&(r=n[1].replace(/[ ]/g,""),"Microsoft Internet Explorer"===t&&("MSIE9.0"===r||"MSIE8.0"===r))}(),t.toPercent=function(e){return e=Number(e),isNaN(e)?"%":(100*e).toFixed(2)+"%"}),h=(t.thousands=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,r=arguments[2];if(e=Number(e),isNaN(e)||!isFinite(e))return"";"boolean"==typeof t&&(r=t,t=2),r&&(e/=1e4);var n=e.toFixed(t||2),o=/(\d{1,3})(?=(\d{3})+(?:\.))/g;if(0===t){return n.replace(o,"$1,").split(".")[0]}return n.replace(o,"$1,")},t.compare=function(e,t,r){if(e===t)return 0;r&&"function"==typeof r&&(e=r(e),t=r(t));var o=void 0===e?"undefined":n(e),i=void 0===t?"undefined":n(t);if("number"===o&&"number"===i)return e-t;if("string"===o&&"string"===i){var a=[e,t],s=[e,t].sort();return a[0]===s[0]?-1:1}return"number"===o?-1:1});t["default"]={getLocationParams:o,getLocationOrigin:i,getLocationRoot:a,getLocationContext:s,parseJSON:u,stringifyJSON:l,formatDate:c,createDate:f,styleSupport:p,toPercent:d,compare:h}},178:function(e,t,r){r(179),e.exports=self.fetch.bind(self)},179:function(e,t){!function(e){"use strict";function t(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function r(e){return"string"!=typeof e&&(e=String(e)),e}function n(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return b.iterable&&(t[Symbol.iterator]=function(){return t}),t}function o(e){this.map={},e instanceof o?e.forEach(function(e,t){this.append(t,e)},this):Array.isArray(e)?e.forEach(function(e){this.append(e[0],e[1])},this):e&&Object.getOwnPropertyNames(e).forEach(function(t){this.append(t,e[t])},this)}function i(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function a(e){return new Promise(function(t,r){e.onload=function(){t(e.result)},e.onerror=function(){r(e.error)}})}function s(e){var t=new FileReader,r=a(t);return t.readAsArrayBuffer(e),r}function u(e){var t=new FileReader,r=a(t);return t.readAsText(e),r}function l(e){for(var t=new Uint8Array(e),r=new Array(t.length),n=0;n<t.length;n++)r[n]=String.fromCharCode(t[n]);return r.join("")}function c(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function f(){return this.bodyUsed=!1,this._initBody=function(e){if(this._bodyInit=e,e)if("string"==typeof e)this._bodyText=e;else if(b.blob&&Blob.prototype.isPrototypeOf(e))this._bodyBlob=e;else if(b.formData&&FormData.prototype.isPrototypeOf(e))this._bodyFormData=e;else if(b.searchParams&&URLSearchParams.prototype.isPrototypeOf(e))this._bodyText=e.toString();else if(b.arrayBuffer&&b.blob&&v(e))this._bodyArrayBuffer=c(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else{if(!b.arrayBuffer||!ArrayBuffer.prototype.isPrototypeOf(e)&&!w(e))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=c(e)}else this._bodyText="";this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):b.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},b.blob&&(this.blob=function(){var e=i(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?i(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(s)}),this.text=function(){var e=i(this);if(e)return e;if(this._bodyBlob)return u(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(l(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},b.formData&&(this.formData=function(){return this.text().then(h)}),this.json=function(){return this.text().then(JSON.parse)},this}function p(e){var t=e.toUpperCase();return E.indexOf(t)>-1?t:e}function d(e,t){t=t||{};var r=t.body;if(e instanceof d){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new o(e.headers)),this.method=e.method,this.mode=e.mode,r||null==e._bodyInit||(r=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"omit",!t.headers&&this.headers||(this.headers=new o(t.headers)),this.method=p(t.method||this.method||"GET"),this.mode=t.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&r)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(r)}function h(e){var t=new FormData;return e.trim().split("&").forEach(function(e){if(e){var r=e.split("="),n=r.shift().replace(/\+/g," "),o=r.join("=").replace(/\+/g," ");t.append(decodeURIComponent(n),decodeURIComponent(o))}}),t}function y(e){var t=new o;return e.split(/\r?\n/).forEach(function(e){var r=e.split(":"),n=r.shift().trim();if(n){var o=r.join(":").trim();t.append(n,o)}}),t}function m(e,t){t||(t={}),this.type="default",this.status="status"in t?t.status:200,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new o(t.headers),this.url=t.url||"",this._initBody(e)}if(!e.fetch){var b={searchParams:"URLSearchParams"in e,iterable:"Symbol"in e&&"iterator"in Symbol,blob:"FileReader"in e&&"Blob"in e&&function(){try{return new Blob,!0}catch(e){return!1}}(),formData:"FormData"in e,arrayBuffer:"ArrayBuffer"in e};if(b.arrayBuffer)var g=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],v=function(e){return e&&DataView.prototype.isPrototypeOf(e)},w=ArrayBuffer.isView||function(e){return e&&g.indexOf(Object.prototype.toString.call(e))>-1};o.prototype.append=function(e,n){e=t(e),n=r(n);var o=this.map[e];this.map[e]=o?o+","+n:n},o.prototype["delete"]=function(e){delete this.map[t(e)]},o.prototype.get=function(e){return e=t(e),this.has(e)?this.map[e]:null},o.prototype.has=function(e){return this.map.hasOwnProperty(t(e))},o.prototype.set=function(e,n){this.map[t(e)]=r(n)},o.prototype.forEach=function(e,t){for(var r in this.map)this.map.hasOwnProperty(r)&&e.call(t,this.map[r],r,this)},o.prototype.keys=function(){var e=[];return this.forEach(function(t,r){e.push(r)}),n(e)},o.prototype.values=function(){var e=[];return this.forEach(function(t){e.push(t)}),n(e)},o.prototype.entries=function(){var e=[];return this.forEach(function(t,r){e.push([r,t])}),n(e)},b.iterable&&(o.prototype[Symbol.iterator]=o.prototype.entries);var E=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];d.prototype.clone=function(){return new d(this,{body:this._bodyInit})},f.call(d.prototype),f.call(m.prototype),m.prototype.clone=function(){return new m(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new o(this.headers),url:this.url})},m.error=function(){var e=new m(null,{status:0,statusText:""});return e.type="error",e};var _=[301,302,303,307,308];m.redirect=function(e,t){if(_.indexOf(t)===-1)throw new RangeError("Invalid status code");return new m(null,{status:t,headers:{location:e}})},e.Headers=o,e.Request=d,e.Response=m,e.fetch=function(e,t){return new Promise(function(r,n){var o=new d(e,t),i=new XMLHttpRequest;i.onload=function(){var e={status:i.status,statusText:i.statusText,headers:y(i.getAllResponseHeaders()||"")};e.url="responseURL"in i?i.responseURL:e.headers.get("X-Request-URL"),r(new m("response"in i?i.response:i.responseText,e))},i.onerror=function(){n(new TypeError("Network request failed"))},i.ontimeout=function(){n(new TypeError("Network request failed"))},i.open(o.method,o.url,!0),"include"===o.credentials&&(i.withCredentials=!0),"responseType"in i&&b.blob&&(i.responseType="blob"),o.headers.forEach(function(e,t){i.setRequestHeader(t,e)}),i.send(void 0===o._bodyInit?null:o._bodyInit)})},e.fetch.polyfill=!0}}("undefined"!=typeof self?self:this)},753:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(0),l=n(u),c=r(44),f=r(758),p=n(f),d=r(755);r(763);var h=function(e){function t(){var e,r,n,a;o(this,t);for(var s=arguments.length,u=Array(s),l=0;l<s;l++)u[l]=arguments[l];return r=n=i(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(u))),n.loadMore=function(){var e=n.props.person,t=n.context.dispatch,r=e.get("isFetching"),o=e.get("paging"),i=o.get("lastPage");r||i||t((0,d.getPersonList)())},n.refresh=function(e){(0,n.context.dispatch)((0,d.getPersonList)(!0))},a=r,i(n,a)}return a(t,e),s(t,[{key:"componentDidMount",value:function(){var e=this.props.person,t=this.context.dispatch;e.get("paging")||t((0,d.getPersonList)(!0))}},{key:"renderList",value:function(){var e=this.props.person,t=(e.get("isFetching"),e.get("paging"));if(!t)return l["default"].createElement("div",{className:"page-loading"},"载入中，请稍后 ...");var r=(t.get("lastPage"),t.get("items"));return 0===r.size?l["default"].createElement("div",{className:"no-items"},l["default"].createElement("div",{className:"no-items-icon"}),l["default"].createElement("p",null,"暂无记录")):l["default"].createElement("div",null,l["default"].createElement("table",{className:"table"},l["default"].createElement("thead",{className:"thead-inverse"},l["default"].createElement("tr",null,l["default"].createElement("th",null,"#"),l["default"].createElement("th",null,"First Name"),l["default"].createElement("th",null,"Last Name"),l["default"].createElement("th",null,"Username"),l["default"].createElement("th",null))),l["default"].createElement("tbody",null,r?r.map(function(e){return l["default"].createElement(p["default"],{key:e.get("id"),person:e})}):null)))}},{key:"render",value:function(){var e=this.props.person,t=e.get("paging"),r=t&&t.get("lastPage");return l["default"].createElement("div",null,l["default"].createElement("div",{className:"mb-1"},l["default"].createElement(c.Link,{className:"btn btn-primary",to:"/person/create"},"Add Person")),this.renderList(),l["default"].createElement("div",{className:"btn-group"},l["default"].createElement("button",{type:"button",className:"btn btn-primary",disabled:r,onClick:this.loadMore},"Load More"),l["default"].createElement("button",{type:"button",className:"btn btn-info",onClick:this.refresh},"Refresh")))}}]),t}(u.Component);h.propTypes={person:u.PropTypes.object},h.contextTypes={dispatch:u.PropTypes.func},t["default"]=h},754:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=function(e,t){return t?t:e.code&&n[e.code]?n[e.code]:e.message&&o[e.message.toLowerCase()]?o[e.message.toLowerCase()]:e.message||"请求失败"};var n={401:"该请求不存在",404:"该请求不存在",500:"服务器出错",501:"格式不对",502:"无网络连接，请检查您的网络！",503:"服务器拒绝","b-001":"获取数据出错"},o={"failed to fetch":"无网络连接，请检查您的网络！","network request failed":"无网络连接，请检查您的网络！"}},755:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(){return{type:"person-list-request"}}function i(e,t){return{type:"person-list-success",data:e,clear:t}}function a(e){return{type:"person-list-failure",error:e}}function s(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments[1];return function(r,n){(0,h["default"])({url:"page-2/person?pageNum="+e}).then(function(e){var n=e.data;return r(e?i(n,t):a("请求失败"))},function(e){return r(a((0,m["default"])(e)))})}}function u(e){return function(t,r){var n=r().get("person"),i=n.get("isFetching"),a=n.get("paging"),u=e!==!0&&a?a.get("pageNum")+1:1,l=!(e===!0||!a)&&a.get("lastPage");return i||l?null:(t(o()),t(s(u,e)))}}function l(){return{type:"person-clear"}}function c(e){return{type:"person-update",person:e}}function f(e){return{type:"person-delete",id:e}}function p(e){return{type:"person-add",person:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.getPersonList=u,t.clearPersonList=l,t.updatePerson=c,t.deletePerson=f,t.addPerson=p;var d=r(176),h=n(d),y=r(754),m=n(y)},758:function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(0),l=n(u),c=r(176),f=n(c),p=r(755);r(762);var d=function(e){function t(e){o(this,t);var r=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.handleEdit=function(e){e.preventDefault(),r.setState({editing:!0})},r.handleCancel=function(e){e.preventDefault(),r.setState({editing:!1,person:r.personDefault})},r.handleSave=function(e){e.preventDefault();var t=r.context.dispatch,n=r.state.person.toJSON();return(0,f["default"])({url:"page-2/person",body:n,method:"post"}).then(function(e){t((0,p.updatePerson)(r.state.person)),r.setState({editing:!1},function(){r.personDefault=r.state.person})},function(e){})},r.handleDelete=function(e){return function(t){t.preventDefault();var n=r.context.dispatch;return(0,f["default"])({url:"page-2/person",body:{id:e},method:"delete"}).then(function(t){n((0,p.deletePerson)(e))},function(e){})}},r.handleChange=function(e){return function(t){var n=r.state.person,o=t.target.value;r.setState({person:n.set(e,o)})}},r.state={editing:!1,person:r.props.person},r.personDefault=r.props.person,r}return a(t,e),s(t,[{key:"textOrInput",value:function(e,t){return this.state.editing?l["default"].createElement("input",{type:"text",value:t,onChange:this.handleChange(e)}):l["default"].createElement("span",null,t)}},{key:"render",value:function(){var e=this.state,t=e.editing,r=e.person,n=r.get("id"),o=r.get("firstName"),i=r.get("lastName");return l["default"].createElement("tr",null,l["default"].createElement("th",null,n),l["default"].createElement("td",null,this.textOrInput("firstName",o)),l["default"].createElement("td",null,this.textOrInput("lastName",i)),l["default"].createElement("td",null,o+i),l["default"].createElement("td",{className:"link-group"},l["default"].createElement("a",{href:"",style:{display:t?"none":"inline"},onClick:this.handleEdit},"编辑"),l["default"].createElement("a",{href:"",style:{display:t?"inline":"none"},onClick:this.handleCancel},"取消"),l["default"].createElement("a",{href:"",style:{display:t?"inline":"none"},onClick:this.handleSave},"保存"),l["default"].createElement("a",{href:"",onClick:this.handleDelete(n)},"删除")))}}]),t}(u.Component);d.propTypes={person:u.PropTypes.object.isRequired},d.contextTypes={dispatch:u.PropTypes.func},t["default"]=d},762:function(e,t){},763:function(e,t){}});